<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#4A148C">
    <title>Match Predictions</title>

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            overflow: hidden;
            background: #f5f5f5;
            position: fixed;
            width: 100%;
            height: 100%;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        /* Hide scrollbars but keep functionality */
        .leagues-container::-webkit-scrollbar,
        .matches-container::-webkit-scrollbar {
            display: none;
        }

        .leagues-container,
        .matches-container {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }

        /* Common Styles */
        .screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            opacity: 0;
            visibility: hidden;
            transform: translateX(100%);
            transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1),
                        opacity 0.4s cubic-bezier(0.4, 0, 0.2, 1),
                        visibility 0.4s;
        }

        .screen.active {
            opacity: 1;
            visibility: visible;
            transform: translateX(0);
        }

        .screen.exit-left {
            transform: translateX(-30%);
            opacity: 0;
        }

        .header {
            display: flex;
            align-items: center;
            margin-bottom: 30px;
            gap: 15px;
        }

        .back-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: rgba(0, 0, 0, 0.1);
            border: none;
            font-size: 20px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .back-btn:active {
            transform: scale(0.95);
        }

        .header-title {
            font-size: 24px;
            font-weight: 800;
        }

        .loading {
            text-align: center;
            padding: 40px;
            color: #666;
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid #4A148C;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Screen 1: Home */
        #home-screen {
            background: linear-gradient(135deg, #4A148C 0%, #1A237E 50%, #B71C1C 100%);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            color: white;
            padding: 20px;
        }

        .home-logo {
            font-size: 48px;
            margin-bottom: 20px;
        }

        .home-title {
            font-size: 32px;
            font-weight: 900;
            margin-bottom: 10px;
        }

        .home-subtitle {
            font-size: 16px;
            margin-bottom: 50px;
            opacity: 0.9;
        }

        .sports-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 20px;
            width: 100%;
            max-width: 400px;
        }

        .sport-card {
            background: white;
            border-radius: 20px;
            padding: 30px;
            cursor: pointer;
            transition: transform 0.2s;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        .sport-card:active {
            transform: scale(0.98);
        }

        .sport-icon {
            font-size: 48px;
            margin-bottom: 15px;
        }

        .sport-name {
            font-size: 24px;
            font-weight: 800;
            color: #333;
            margin-bottom: 5px;
        }

        .sport-subtitle {
            font-size: 14px;
            color: #666;
        }

        /* Screen 2: Leagues */
        #leagues-screen {
            background: #f5f5f5;
            display: flex;
            flex-direction: column;
            padding: 20px;
        }

        .leagues-container {
            flex: 1;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
        }

        .leagues-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 15px;
            padding-bottom: 20px;
        }

        .league-card {
            background: white;
            border-radius: 16px;
            padding: 20px;
            display: flex;
            align-items: center;
            gap: 15px;
            cursor: pointer;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            transition: transform 0.2s;
        }

        .league-card:active {
            transform: scale(0.98);
        }

        .league-icon {
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, #4A148C, #B71C1C);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 28px;
            flex-shrink: 0;
        }

        .league-info {
            flex: 1;
        }

        .league-name {
            font-size: 18px;
            font-weight: 700;
            color: #333;
            margin-bottom: 5px;
        }

        .league-country {
            font-size: 14px;
            color: #666;
        }

        /* Screen 3: Matches */
        #matches-screen {
            background: #f5f5f5;
            display: flex;
            flex-direction: column;
            padding: 20px;
        }

        .matches-container {
            flex: 1;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
        }

        .matches-list {
            display: flex;
            flex-direction: column;
            gap: 15px;
            padding-bottom: 20px;
        }

        .match-card {
            background: white;
            border-radius: 16px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .match-date {
            font-size: 12px;
            color: #666;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 15px;
        }

        .match-teams {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
        }

        .match-team {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
        }

        .team-badge {
            width: 60px;
            height: 60px;
            background: #f0f0f0;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
        }

        .team-badge img {
            width: 50px;
            height: 50px;
            object-fit: contain;
        }

        .team-name {
            font-size: 14px;
            font-weight: 700;
            text-align: center;
            color: #333;
        }

        .match-vs {
            font-size: 16px;
            font-weight: 900;
            color: #999;
            padding: 0 15px;
        }

        .predict-btn {
            width: 100%;
            padding: 15px;
            background: #00FF8C;
            border: none;
            border-radius: 12px;
            color: #000000;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            text-transform: uppercase;
        }

        .predict-btn:active {
            transform: scale(0.98);
            background: #00DD7A;
        }

        .no-matches {
            text-align: center;
            padding: 60px 20px;
            color: #999;
        }

        .no-matches-icon {
            font-size: 64px;
            margin-bottom: 20px;
        }

        /* Screen 4: Prediction */
        #prediction-screen {
            background: linear-gradient(135deg, #4A148C 0%, #1A237E 50%, #B71C1C 100%);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .prediction-card {
            background: white;
            border-radius: 24px;
            padding: 40px 30px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
            max-width: 400px;
            width: 90%;
        }

        .card-title {
            text-align: center;
            font-size: 24px;
            font-weight: 800;
            margin-bottom: 10px;
            color: #000;
        }

        .card-subtitle {
            text-align: center;
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 30px;
            color: #333;
        }

        .teams-container {
            display: flex;
            gap: 30px;
            justify-content: center;
            margin-bottom: 30px;
        }

        .team-box {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 15px;
            padding: 20px;
            border-radius: 16px;
            border: 3px solid #e0e0e0;
        }

        .team-box.selected {
            border-color: #4CAF50;
            border-width: 4px;
            background: #f1f8f4;
        }

        .team-logo {
            width: 80px;
            height: 80px;
            border-radius: 12px;
            background: #f5f5f5;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .team-logo img {
            width: 70px;
            height: 70px;
            object-fit: contain;
        }

        .vs-text {
            font-size: 20px;
            font-weight: 900;
            color: #666;
            align-self: center;
        }

        .prediction-team-name {
            font-size: 12px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: #333;
            text-align: center;
        }

        .score-input {
            font-size: 48px;
            font-weight: 900;
            text-align: center;
            color: #000;
            min-width: 80px;
        }

        .score-controls {
            display: flex;
            gap: 10px;
        }

        .score-btn {
            width: 45px;
            height: 45px;
            border-radius: 12px;
            border: none;
            background: #00FF8C;
            color: #000000;
            font-size: 24px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.2s;
        }

        .score-btn:active {
            transform: scale(0.95);
            background: #00DD7A;
        }

        .winner-badge {
            background: #4CAF50;
            color: white;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 10px;
            font-weight: 800;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .share-btn {
            width: 100%;
            padding: 18px;
            background: #00FF8C;
            border: none;
            border-radius: 16px;
            color: #000000;
            font-size: 16px;
            font-weight: 700;
            text-transform: uppercase;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .share-btn:active {
            transform: scale(0.98);
            background: #00DD7A;
        }
    </style>
</head>
<body>
    <!-- Screen 1: Home -->
    <div id="home-screen" class="screen active">
        <div class="home-logo">⚽</div>
        <h1 class="home-title">Match Predictions</h1>
        <p class="home-subtitle">Pick your sport and make your predictions</p>

        <div class="sports-grid">
            <div class="sport-card" onclick="navigateTo('leagues')">
                <div class="sport-icon">⚽</div>
                <div class="sport-name">Football</div>
                <div class="sport-subtitle">View leagues & matches</div>
            </div>
        </div>
    </div>

    <!-- Screen 2: Leagues -->
    <div id="leagues-screen" class="screen">
        <div class="header">
            <button class="back-btn" onclick="navigateTo('home')">←</button>
            <h2 class="header-title">Football Leagues</h2>
        </div>

        <div class="leagues-container">
            <div id="leagues-loading" class="loading">
                <div class="spinner"></div>
                <p>Loading leagues...</p>
            </div>

            <div id="leagues-grid" class="leagues-grid"></div>
        </div>
    </div>

    <!-- Screen 3: Matches -->
    <div id="matches-screen" class="screen">
        <div class="header">
            <button class="back-btn" onclick="navigateTo('leagues')">←</button>
            <h2 class="header-title" id="matches-title">Upcoming Matches</h2>
        </div>

        <div class="matches-container">
            <div id="matches-loading" class="loading">
                <div class="spinner"></div>
                <p>Loading matches...</p>
            </div>

            <div id="matches-list" class="matches-list"></div>

            <div id="no-matches" class="no-matches" style="display: none;">
                <div class="no-matches-icon">📅</div>
                <h3>No Upcoming Matches</h3>
                <p>Check back later for new fixtures</p>
            </div>
        </div>
    </div>

    <!-- Screen 4: Prediction -->
    <div id="prediction-screen" class="screen">
        <div class="header" style="position: absolute; top: 20px; left: 20px; z-index: 10;">
            <button class="back-btn" onclick="navigateTo('matches')" style="background: rgba(255, 255, 255, 0.3); color: white;">←</button>
        </div>

        <div class="prediction-card">
            <div class="card-title">Make Your Prediction!</div>
            <div class="card-subtitle">Share your score and WIN!</div>

            <div class="teams-container">
                <div class="team-box" id="prediction-team-home">
                    <div class="team-logo">
                        <img id="pred-home-logo" src="" alt="" onerror="this.style.display='none'">
                    </div>
                    <div class="prediction-team-name" id="pred-home-name">Team 1</div>
                    <div class="score-input" id="score-home">0</div>
                    <div class="score-controls">
                        <button class="score-btn" onclick="adjustScore('home', -1)">−</button>
                        <button class="score-btn" onclick="adjustScore('home', 1)">+</button>
                    </div>
                    <div class="winner-badge" id="winner-home" style="visibility: hidden;">WINNER!</div>
                </div>

                <div class="vs-text">VS</div>

                <div class="team-box" id="prediction-team-away">
                    <div class="team-logo">
                        <img id="pred-away-logo" src="" alt="" onerror="this.style.display='none'">
                    </div>
                    <div class="prediction-team-name" id="pred-away-name">Team 2</div>
                    <div class="score-input" id="score-away">0</div>
                    <div class="score-controls">
                        <button class="score-btn" onclick="adjustScore('away', -1)">−</button>
                        <button class="score-btn" onclick="adjustScore('away', 1)">+</button>
                    </div>
                    <div class="winner-badge" id="winner-away" style="visibility: hidden;">WINNER!</div>
                </div>
            </div>

            <button class="share-btn" onclick="sharePrediction()">
                📤 SHARE PREDICTION
            </button>
        </div>
    </div>

    <script>
        // App State
        const state = {
            currentScreen: 'home',
            selectedLeague: null,
            selectedMatch: null,
            scores: { home: 0, away: 0 },
            leagues: [],
            matches: []
        };

        const API_BASE = 'https://www.thesportsdb.com/api/v1/json/3';

        // Popular leagues for MVP
        const FEATURED_LEAGUES = [
            { id: '4328', name: 'English Premier League', country: 'England', icon: '🏴󠁧󠁢󠁥󠁮󠁧󠁿' },
            { id: '4335', name: 'Spanish La Liga', country: 'Spain', icon: '🇪🇸' },
            { id: '4332', name: 'Italian Serie A', country: 'Italy', icon: '🇮🇹' },
            { id: '4331', name: 'German Bundesliga', country: 'Germany', icon: '🇩🇪' },
            { id: '4334', name: 'French Ligue 1', country: 'France', icon: '🇫🇷' }
        ];

        // Navigation
        function navigateTo(screen, data = null) {
            console.log(`Navigating to ${screen}`, data);

            const currentScreen = document.querySelector('.screen.active');
            const targetScreen = document.getElementById(`${screen}-screen`);

            // Remove all screens from active/exit states
            document.querySelectorAll('.screen').forEach(s => {
                s.classList.remove('active', 'exit-left');
            });

            // Determine navigation direction
            const screenOrder = ['home', 'leagues', 'matches', 'prediction'];
            const currentIndex = screenOrder.indexOf(state.currentScreen);
            const targetIndex = screenOrder.indexOf(screen);
            const isForward = targetIndex > currentIndex;

            // Animate current screen out
            if (currentScreen && !isForward) {
                currentScreen.classList.add('exit-left');
            }

            // Show target screen
            setTimeout(() => {
                targetScreen.classList.add('active');
            }, isForward ? 0 : 50);

            state.currentScreen = screen;

            // Load data based on screen
            if (screen === 'leagues') {
                loadLeagues();
            } else if (screen === 'matches' && data) {
                state.selectedLeague = data;
                loadMatches(data.id, data.name);
            } else if (screen === 'prediction' && data) {
                state.selectedMatch = data;
                loadPrediction(data);
            }
        }

        // Load Leagues
        async function loadLeagues() {
            const loading = document.getElementById('leagues-loading');
            const grid = document.getElementById('leagues-grid');

            loading.style.display = 'block';
            grid.innerHTML = '';

            // Use featured leagues for MVP
            setTimeout(() => {
                loading.style.display = 'none';

                FEATURED_LEAGUES.forEach(league => {
                    const card = document.createElement('div');
                    card.className = 'league-card';
                    card.onclick = () => navigateTo('matches', league);
                    card.innerHTML = `
                        <div class="league-icon">${league.icon}</div>
                        <div class="league-info">
                            <div class="league-name">${league.name}</div>
                            <div class="league-country">${league.country}</div>
                        </div>
                    `;
                    grid.appendChild(card);
                });
            }, 500);
        }

        // Load Matches
        async function loadMatches(leagueId, leagueName) {
            const loading = document.getElementById('matches-loading');
            const list = document.getElementById('matches-list');
            const noMatches = document.getElementById('no-matches');
            const title = document.getElementById('matches-title');

            title.textContent = leagueName;
            loading.style.display = 'block';
            list.innerHTML = '';
            noMatches.style.display = 'none';

            try {
                // Use current season: 2025-2026
                const response = await fetch(`${API_BASE}/eventsseason.php?id=${leagueId}&s=2025-2026`);
                const data = await response.json();

                loading.style.display = 'none';

                if (!data.events || data.events.length === 0) {
                    noMatches.style.display = 'block';
                    return;
                }

                // Filter for upcoming matches only (future dates)
                const today = new Date();
                today.setHours(0, 0, 0, 0);

                const upcomingMatches = data.events.filter(match => {
                    const matchDate = new Date(match.dateEvent);
                    return matchDate >= today;
                });

                if (upcomingMatches.length === 0) {
                    noMatches.style.display = 'block';
                    return;
                }

                // Show up to 10 upcoming matches
                const matches = upcomingMatches.slice(0, 10);

                matches.forEach(match => {
                    const card = document.createElement('div');
                    card.className = 'match-card';

                    const date = new Date(match.dateEvent + 'T' + (match.strTime || '00:00'));
                    const formattedDate = date.toLocaleDateString('en-US', {
                        weekday: 'short',
                        month: 'short',
                        day: 'numeric',
                        hour: '2-digit',
                        minute: '2-digit'
                    });

                    card.innerHTML = `
                        <div class="match-date">${formattedDate}</div>
                        <div class="match-teams">
                            <div class="match-team">
                                <div class="team-badge">
                                    <img src="${match.strHomeTeamBadge || ''}" alt="${match.strHomeTeam}" onerror="this.parentElement.innerHTML='⚽'">
                                </div>
                                <div class="team-name">${match.strHomeTeam}</div>
                            </div>
                            <div class="match-vs">VS</div>
                            <div class="match-team">
                                <div class="team-badge">
                                    <img src="${match.strAwayTeamBadge || ''}" alt="${match.strAwayTeam}" onerror="this.parentElement.innerHTML='⚽'">
                                </div>
                                <div class="team-name">${match.strAwayTeam}</div>
                            </div>
                        </div>
                        <button class="predict-btn" onclick='selectMatch(${JSON.stringify({
                            homeTeam: match.strHomeTeam,
                            awayTeam: match.strAwayTeam,
                            homeBadge: match.strHomeTeamBadge || '',
                            awayBadge: match.strAwayTeamBadge || '',
                            date: formattedDate
                        })})'>Make Prediction</button>
                    `;

                    list.appendChild(card);
                });

            } catch (error) {
                console.error('Error loading matches:', error);
                loading.style.display = 'none';
                noMatches.style.display = 'block';
            }
        }

        // Select Match
        function selectMatch(matchData) {
            navigateTo('prediction', matchData);
        }

        // Load Prediction Screen
        function loadPrediction(match) {
            document.getElementById('pred-home-name').textContent = match.homeTeam;
            document.getElementById('pred-away-name').textContent = match.awayTeam;
            document.getElementById('pred-home-logo').src = match.homeBadge;
            document.getElementById('pred-away-logo').src = match.awayBadge;

            // Reset scores
            state.scores = { home: 0, away: 0 };
            document.getElementById('score-home').textContent = '0';
            document.getElementById('score-away').textContent = '0';
            updateWinnerBadges();
        }

        // Adjust Score
        function adjustScore(team, delta) {
            state.scores[team] = Math.max(0, Math.min(99, state.scores[team] + delta));
            document.getElementById(`score-${team}`).textContent = state.scores[team];
            updateWinnerBadges();
        }

        // Update Winner Badges
        function updateWinnerBadges() {
            const homeBox = document.getElementById('prediction-team-home');
            const awayBox = document.getElementById('prediction-team-away');
            const homeBadge = document.getElementById('winner-home');
            const awayBadge = document.getElementById('winner-away');

            if (state.scores.home > state.scores.away) {
                homeBadge.style.visibility = 'visible';
                awayBadge.style.visibility = 'hidden';
                homeBox.classList.add('selected');
                awayBox.classList.remove('selected');
            } else if (state.scores.away > state.scores.home) {
                homeBadge.style.visibility = 'hidden';
                awayBadge.style.visibility = 'visible';
                homeBox.classList.remove('selected');
                awayBox.classList.add('selected');
            } else {
                homeBadge.style.visibility = 'hidden';
                awayBadge.style.visibility = 'hidden';
                homeBox.classList.remove('selected');
                awayBox.classList.remove('selected');
            }
        }

        // Share Prediction
        function sharePrediction() {
            const match = state.selectedMatch;
            const text = `My prediction:\n${match.homeTeam} ${state.scores.home} - ${state.scores.away} ${match.awayTeam}`;

            if (navigator.share) {
                navigator.share({
                    title: 'My Match Prediction',
                    text: text
                }).catch(err => console.log('Share cancelled'));
            } else {
                // Fallback: Copy to clipboard
                navigator.clipboard.writeText(text).then(() => {
                    alert('Prediction copied to clipboard!');
                });
            }
        }

        // Initialize
        console.log('🚀 Match Predictions App loaded');
    </script>
</body>
</html>
